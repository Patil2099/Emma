



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.4.2">
    
    
      
        <title>Emma - Emma Memmory and Mapfile Analyser</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/application.30686662.css">
      
        <link rel="stylesheet" href="assets/stylesheets/application-palette.a8b3c06d.css">
      
      
        
        
        <meta name="theme-color" content="">
      
    
    
      <script src="assets/javascripts/modernizr.74668098.js"></script>
    
    
      
    
    <link rel="stylesheet" href="assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="black" data-md-color-accent="amber">
  
    <svg class="md-svg">
      <defs>
        
        
          <svg xmlns="http://www.w3.org/2000/svg" width="416" height="448" viewBox="0 0 416 448" id="__github"><path fill="currentColor" d="M160 304q0 10-3.125 20.5t-10.75 19T128 352t-18.125-8.5-10.75-19T96 304t3.125-20.5 10.75-19T128 256t18.125 8.5 10.75 19T160 304zm160 0q0 10-3.125 20.5t-10.75 19T288 352t-18.125-8.5-10.75-19T256 304t3.125-20.5 10.75-19T288 256t18.125 8.5 10.75 19T320 304zm40 0q0-30-17.25-51T296 232q-10.25 0-48.75 5.25Q229.5 240 208 240t-39.25-2.75Q130.75 232 120 232q-29.5 0-46.75 21T56 304q0 22 8 38.375t20.25 25.75 30.5 15 35 7.375 37.25 1.75h42q20.5 0 37.25-1.75t35-7.375 30.5-15 20.25-25.75T360 304zm56-44q0 51.75-15.25 82.75-9.5 19.25-26.375 33.25t-35.25 21.5-42.5 11.875-42.875 5.5T212 416q-19.5 0-35.5-.75t-36.875-3.125-38.125-7.5-34.25-12.875T37 371.5t-21.5-28.75Q0 312 0 260q0-59.25 34-99-6.75-20.5-6.75-42.5 0-29 12.75-54.5 27 0 47.5 9.875t47.25 30.875Q171.5 96 212 96q37 0 70 8 26.25-20.5 46.75-30.25T376 64q12.75 25.5 12.75 54.5 0 21.75-6.75 42 34 40 34 99.5z"/></svg>
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#emma" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="index.html" title="Emma Memmory and Mapfile Analyser" class="md-header-nav__button md-logo">
          
            <i class="md-icon">üîç</i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              Emma Memmory and Mapfile Analyser
            </span>
            <span class="md-header-nav__topic">
              
                Emma
              
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
        <div class="md-flex__cell md-flex__cell--shrink">
          <div class="md-header-nav__source">
            


  

<a href="https://github.com/bmwcarit/Emma.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Emma Memmory and Mapfile Analyser
  </div>
</a>
          </div>
        </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main" role="main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href="index.html" title="Emma Memmory and Mapfile Analyser" class="md-nav__button md-logo">
      
        <i class="md-icon">üîç</i>
      
    </a>
    Emma Memmory and Mapfile Analyser
  </label>
  
    <div class="md-nav__source">
      


  

<a href="https://github.com/bmwcarit/Emma.git/" title="Go to repository" class="md-source" data-md-source="github">
  
    <div class="md-source__icon">
      <svg viewBox="0 0 24 24" width="24" height="24">
        <use xlink:href="#__github" width="24" height="24"></use>
      </svg>
    </div>
  
  <div class="md-source__repository">
    Emma Memmory and Mapfile Analyser
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href="index.html" title="Home" class="md-nav__link">
      Home
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Emma
      </label>
    
    <a href="readme-emma.html" title="Emma" class="md-nav__link md-nav__link--active">
      Emma
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process" class="md-nav__link">
    Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-arguments" class="md-nav__link">
    Required Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-arguments" class="md-nav__link">
    Optional Arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-configuration" class="md-nav__link">
    Project Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formal-definition-of-the-generic-configuration" class="md-nav__link">
    Formal definition of the generic configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project" class="md-nav__link">
    PROJECT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supplement" class="md-nav__link">
    supplement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globalconfigjson" class="md-nav__link">
    globalConfig.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addressspacesjson" class="md-nav__link">
    addressSpaces*.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#budgetsjson" class="md-nav__link">
    budgets.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categoriesobjectsjson-and-categoriessectionsjson" class="md-nav__link">
    categoriesObjects.json and categoriesSections.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categoriesobjectskeywordsjson-and-categoriessectionskeywordsjson" class="md-nav__link">
    categoriesObjectsKeywords.json and categoriesSectionsKeywords.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formal-definition-of-the-ghs-compiler-specific-configuration" class="md-nav__link">
    Formal Definition of the GHS compiler specific configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extensions-to-the-globalconfigjson" class="md-nav__link">
    Extensions to the globalConfig.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patternsjson" class="md-nav__link">
    patterns*.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtualsectionsjson" class="md-nav__link">
    virtualSections*.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output Files
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-summary" class="md-nav__link">
    Section Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-summary" class="md-nav__link">
    Object Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-in-sections" class="md-nav__link">
    Objects in Sections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-header" class="md-nav__link">
    CSV header
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminology" class="md-nav__link">
    Terminology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-object-name-and-category-using-categorieskeywordsjson" class="md-nav__link">
    Matching object name and category using categoriesKeywords.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-not-needed-object-names-from-categoriesobjectsjson" class="md-nav__link">
    Removing not needed object names from categoriesObjects.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-information-about-map-files-and-build-chains" class="md-nav__link">
    General Information About Map Files and Build Chains
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details" class="md-nav__link">
    Technical Details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ghs-monolith-file-generation" class="md-nav__link">
    GHS Monolith file generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-diagram-emma" class="md-nav__link">
    Class diagram Emma
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-graph-emma" class="md-nav__link">
    Calling Graph Emma
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="readme-vis.html" title="Emma Visualiser" class="md-nav__link">
      Emma Visualiser
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="test_project/readme.html" title="Test Project" class="md-nav__link">
      Test Project
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="dev-guide.html" title="Developer Guide" class="md-nav__link">
      Developer Guide
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#requirements" class="md-nav__link">
    Requirements
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#process" class="md-nav__link">
    Process
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limitations" class="md-nav__link">
    Limitations
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#arguments" class="md-nav__link">
    Arguments
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#required-arguments" class="md-nav__link">
    Required Arguments
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#optional-arguments" class="md-nav__link">
    Optional Arguments
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#project-configuration" class="md-nav__link">
    Project Configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#formal-definition-of-the-generic-configuration" class="md-nav__link">
    Formal definition of the generic configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project" class="md-nav__link">
    PROJECT
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supplement" class="md-nav__link">
    supplement
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#globalconfigjson" class="md-nav__link">
    globalConfig.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#addressspacesjson" class="md-nav__link">
    addressSpaces*.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#budgetsjson" class="md-nav__link">
    budgets.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categoriesobjectsjson-and-categoriessectionsjson" class="md-nav__link">
    categoriesObjects.json and categoriesSections.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#categoriesobjectskeywordsjson-and-categoriessectionskeywordsjson" class="md-nav__link">
    categoriesObjectsKeywords.json and categoriesSectionsKeywords.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#formal-definition-of-the-ghs-compiler-specific-configuration" class="md-nav__link">
    Formal Definition of the GHS compiler specific configuration
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#extensions-to-the-globalconfigjson" class="md-nav__link">
    Extensions to the globalConfig.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#patternsjson" class="md-nav__link">
    patterns*.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#virtualsectionsjson" class="md-nav__link">
    virtualSections*.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#output-files" class="md-nav__link">
    Output Files
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#section-summary" class="md-nav__link">
    Section Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#object-summary" class="md-nav__link">
    Object Summary
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#objects-in-sections" class="md-nav__link">
    Objects in Sections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#csv-header" class="md-nav__link">
    CSV header
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#terminology" class="md-nav__link">
    Terminology
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#examples" class="md-nav__link">
    Examples
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#matching-object-name-and-category-using-categorieskeywordsjson" class="md-nav__link">
    Matching object name and category using categoriesKeywords.json
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#removing-not-needed-object-names-from-categoriesobjectsjson" class="md-nav__link">
    Removing not needed object names from categoriesObjects.json
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#general-information-about-map-files-and-build-chains" class="md-nav__link">
    General Information About Map Files and Build Chains
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technical-details" class="md-nav__link">
    Technical Details
  </a>
  
    <nav class="md-nav">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ghs-monolith-file-generation" class="md-nav__link">
    GHS Monolith file generation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#class-diagram-emma" class="md-nav__link">
    Class diagram Emma
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#calling-graph-emma" class="md-nav__link">
    Calling Graph Emma
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                  <a href="https://github.com/bmwcarit/Emma.git/edit/master/docs/readme-emma.md" title="Edit this page" class="md-icon md-content__icon">&#xE3C9;</a>
                
                
                <h1 id="emma">Emma<a class="headerlink" href="#emma" title="Permanent link">&para;</a></h1>
<p><strong>Emma Memory and Mapfile Analyser</strong></p>
<blockquote>
<p>Conduct static (i.e. worst case) memory consumption analyses based on linker map files (currently only Green Hills map files are supported).
This tool creates a summary/overview about static memory usage in form of a comma separated values (CSV) file.</p>
</blockquote>
<h2 id="requirements">Requirements<a class="headerlink" href="#requirements" title="Permanent link">&para;</a></h2>
<ul>
<li>Python 3.6 or higher</li>
<li>Python libraries<ul>
<li>pypiscout 2.0 or higher: (<code>pip3 install pypiscout</code>)</li>
</ul>
</li>
<li>Tested on Windows and Linux systems</li>
</ul>
<h2 id="process">Process<a class="headerlink" href="#process" title="Permanent link">&para;</a></h2>
<p>Using the Mapfile Analyser is a two step process. The first step is to extract the required information from the mapfiles and save it to .csv files.
This is done with the <code>Emma.py a</code> script. The second step is to visualise the data. This document explains the first part only, the visualisation is documented in the Emma visualiser readme document.</p>
<h2 id="limitations">Limitations<a class="headerlink" href="#limitations" title="Permanent link">&para;</a></h2>
<p>The Emma is only suitable for analyzing projects where the devices have a single linear physical address space:</p>
<ul>
<li>Devices that use for example the Intel 8051 architecture have separate code and data address spaces that both
    start at address 0x0000. Devices based on architectures like this can not be analyzed with Emma.</li>
<li>Devices that use for example the ARMv6M architecture have a single linear address space.
    Devices based on architectures like this can be analyzed with Emma.</li>
</ul>
<h2 id="arguments">Arguments<a class="headerlink" href="#arguments" title="Permanent link">&para;</a></h2>
<h3 id="required-arguments">Required Arguments<a class="headerlink" href="#required-arguments" title="Permanent link">&para;</a></h3>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="c1">--project PROJECT, -p PROJECT</span>

<span class="c1">--mapfiles MAPFILES, --map MAPFILES</span>
</pre></div>
</td></tr></table>

<h3 id="optional-arguments">Optional Arguments<a class="headerlink" href="#optional-arguments" title="Permanent link">&para;</a></h3>
<ul>
<li><code>--dir</code><ul>
<li>User defined path for the top folder holding the <code>memStats</code>/output files. Per default it uses the same directory as the config files.</li>
</ul>
</li>
<li><code>--stats_dir</code></li>
<li>User defined path inside the folder given in the <code>--dir</code> argument. This is usefull when batch analysing mapfiles from various development stages. Every analysis output gets it's own directory.</li>
<li><code>--create_categories</code></li>
<li>Create <code>categories*.json</code> from <code>categories*Keywords.json</code> for easier categorisation.</li>
<li><code>--remove_unmatched</code>,</li>
<li>Remove unmatched entries from <code>categories*.json</code>. This is useful when a <code>categories*.json</code> from another project is used.</li>
<li><code>--analyse_debug</code>, <code>--dbg</code></li>
<li>Normally we remove DWARF debug sections from the analysis to show the relevant information for a possible release software. This can be prevented if this argument is set. DWARF section names are defined in <code>stringConstants.py</code>. <code>.unused_ram</code> is always excluded (regardless of this flag)</li>
<li><code>--noprompt</code></li>
<li>Exit and fail on user prompt. Normally this happens when some files or configurations are ambiguous. This is useful when running Emma on CI systems.</li>
</ul>
<h2 id="project-configuration">Project Configuration<a class="headerlink" href="#project-configuration" title="Permanent link">&para;</a></h2>
<p>The memory analysis will be executed based on the project configuration. In order to be able to use Emma with your project, you need to create a configuration matching your project's hardware and software. <strong>Configure Emma with high diligence since errors may lead to incorrect results of your analysis</strong>. During the analysis Emma performs some sanity checks which helps you detecting misconfiguration.</p>
<p>This chapter explains the role and functionality of each part of the configuration and illustrates all the settings that can be used.
Based on this description the user will have to create his/her own configuration.</p>
<p>Creating a configuration is done by writing several JSON files (if you are not familiar with JSON, please visit <a href="https://www.json.org">https://www.json.org</a>).
This chapter will go trough the topic by formally defining the format, rules and the functionality of the config files.
There are practical example projects available in the <strong><code>doc</code></strong> folder. These projects will lead you step by step trough the process of
creating a configuration and they also contain map files that can be analyzed.</p>
<p>Currently the following example projects are available:</p>
<ul>
<li><strong><code>doc/test_project</code></strong> - A project that illustrates a system with a hardware that consists of two devices: an MCU and an SOC.
Both of the devices have a GHS compiler specific configuration and mapfiles.</li>
</ul>
<p>An Emma project configuration consists of two parts: the generic configuration and the compiler specific configuration.</p>
<h3 id="formal-definition-of-the-generic-configuration">Formal definition of the generic configuration<a class="headerlink" href="#formal-definition-of-the-generic-configuration" title="Permanent link">&para;</a></h3>
<p>The generic part of the configuration contains the following files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">+</span><span class="c1">-- [&lt;PROJECT&gt;]</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- [supplement]</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- globalConfig.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- addressSpaces*.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- budgets.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- categoriesObjects.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- categoriesObjectsKeywords.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- categoriesSections.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- categoriesSectionsKeywords.json</span>
<span class="o">|</span><span class="w">   </span><span class="o">+</span><span class="c1">-- &lt;COMPILER_SPECIFIC_CONFIGURATION_FILES&gt;</span>
</pre></div>
</td></tr></table>

<p>The files containing the asterisk symbol can be freely named by the user because the actual file names will have to be
listed in the globalConfig.json.</p>
<h4 id="project"><code>PROJECT</code><a class="headerlink" href="#project" title="Permanent link">&para;</a></h4>
<p>The configuration has to be contained by a folder. The name of the folder will be the name of the configuration.
From the files ending with a * symbol, the configuration can contain more than one but maximum up to the number of configIDs defined in globalConfig.json.</p>
<h4 id="supplement"><code>supplement</code><a class="headerlink" href="#supplement" title="Permanent link">&para;</a></h4>
<p>You can add .md files into this folder with Markdown syntax to add information regarding your project that will be contained by the .html overview.
For more information please refer to the Emma Visualiser's documentation.</p>
<h4 id="globalconfigjson"><code>globalConfig.json</code><a class="headerlink" href="#globalconfigjson" title="Permanent link">&para;</a></h4>
<p>The globalConfig.json is the starting point of a configuration, this file defines the <strong>configId</strong>-s.
The configId-s are the hardware units of the system that have memory associated to them, for example an MCU, MPU or an SOC.
During the analysis, it will be examined to which extent these memory resources are used.</p>
<p>For each configId, globalConfig.json assigns a compiler. This means that the mapfiles belonging to the configId were created by the selected compiler.
This is important, since the format of these files are specific to the compiler. For each configId an addressSpaces*.json config file will be assigned.
Furthermore the globalConfig.json assigns compiler specific config files to each configId, that need to be consistent with the selected compiler.
For example if a GHS compiler was selected to the configId, then the compiler specific configuration part of this configId have to fulfill the requirements
described in the <a href="#formal-definition-of-the-GHS-compiler-specific-configuration">Formal Definition of the GHS compiler specific configuration</a> chapter.</p>
<p>The globalConfig.json has to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;&lt;CONFIG_ID&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;compiler&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;COMPILER_NAME&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;addressSpacesPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mapfiles&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;MAPFILES_REL_PATH&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ignoreConfigID&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;BOOL&gt;&quot;</span><span class="p">,</span>
        <span class="err">&lt;COMPILER_SPECIFIC_KEY_VALUE_PAIRS&gt;</span>
    <span class="p">},</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="nt">&quot;&lt;CONFIG_ID&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;compiler&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;COMPILER_NAME&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;addressSpacesPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;mapfiles&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;MAPFILES_REL_PATH&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;ignoreConfigID&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;BOOL&gt;&quot;</span><span class="p">,</span>
        <span class="err">&lt;COMPILER_SPECIFIC_KEY_VALUE_PAIRS&gt;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;CONFIG_ID&gt;</code> is a string</li>
<li><code>&lt;COMPILER_NAME&gt;</code> is a string</li>
<li><code>&lt;CONFIG_FILE&gt;</code> is a string </li>
<li><code>&lt;MAPFILES_REL_PATH&gt;</code> is a string, with the special characters escaped in it</li>
<li><code>&lt;BOOL&gt;</code> is a boolean value containing either <strong>true</strong> or <strong>false</strong>  </li>
<li><code>&lt;COMPILER_SPECIFIC_KEY_VALUE_PAIRS&gt;</code> are the key-value pairs that are required by the selected compiler</li>
</ul>
</li>
<li>There has to be at least one <strong>configID</strong> defined</li>
<li>You must select a compiler for every configID, by defining the <strong>compiler</strong> key. The possible values are:<ul>
<li>"GHS" - Green Hills Compiler</li>
</ul>
</li>
<li>You must assign the following config files for each configID by defining the following key, value pairs:<ul>
<li>by defining <strong>addressSpacesPath</strong>, the config file that defines the address spaces is assigned</li>
<li>The config files have to be in the same folder as the globalConfig.json</li>
<li>The config files don't need to be different for each configID (for example you can use the same address spaces config file for all the configIDs)</li>
</ul>
</li>
<li>The mapfiles:<ul>
<li>specifies a folder <strong>relative</strong> to the one given via <strong>--mapfiles</strong> command line argument</li>
<li>is optional, if is defined for a configID, then the map files belonging to this configId will be searched for within this folder</li>
<li>Otherwise the mapfiles will be searched for in the <strong>--mapfiles</strong> root map file path</li>
</ul>
</li>
<li>The ignoreConfigID:<ul>
<li>can be used to mark a configID as ignored, which means that this will not be processed during the analysis</li>
<li>is optional, it does not need to be included in every configID, leaving it has the same effect as including it with false</li>
</ul>
</li>
</ul>
<h4 id="addressspacesjson"><code>addressSpaces*.json</code><a class="headerlink" href="#addressspacesjson" title="Permanent link">&para;</a></h4>
<p>The address spaces config files define the existing memory areas for the configIDs they were assigned to in the globalConfigs.json.</p>
<p>These config files have to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;offset&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ADDRESS&gt;&quot;</span><span class="p">,</span>
    <span class="nt">&quot;memory&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ADDRESS&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;end&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ADDRESS&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;MEMORY_TYPE&gt;&quot;</span>
        <span class="p">},</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="nt">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;start&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ADDRESS&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;end&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;ADDRESS&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;MEMORY_TYPE&gt;&quot;</span>
        <span class="p">}</span>
    <span class="p">},</span>
    <span class="nt">&quot;ignoreMemory&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;ADDRESS&gt;</code> is a string containing a 64bit hexadecimal value, for example "0x1FFFFFFF" </li>
<li><code>&lt;MEMORY_AREA&gt;</code> is a string containing a unique name</li>
<li><code>&lt;MEMORY_TYPE&gt;</code> is a string containing one of the following values:<ul>
<li>"INT_RAM" - internal RAM</li>
<li>"EXT_RAM" - external RAM</li>
<li>"INT_FLASH" - internal Flash</li>
<li>"EXT_FLASH" - external Flash     </li>
</ul>
</li>
</ul>
</li>
<li>The <strong>offset</strong> is a global address offset applied to all addresses in the file</li>
<li><strong>memory</strong> is a JSON object that defines the memory areas</li>
<li>Each memory area is a JSON object that has three elements:<ul>
<li>start - start address</li>
<li>end - end address</li>
<li>type - memory type</li>
</ul>
</li>
<li>The <strong>ignoreMemory</strong> is a JSON array used to mark one or more <code>&lt;MEMORY_AREA&gt;</code> to be ignored during the analysis:<ul>
<li>The the elements of this array can be selected from the ones defined in the "memory" object</li>
<li>It is optional, not including it or including it as an empty array means none of the <code>&lt;MEMORY_AREA&gt;</code>s are ignored</li>
</ul>
</li>
</ul>
<h4 id="budgetsjson"><code>budgets.json</code><a class="headerlink" href="#budgetsjson" title="Permanent link">&para;</a></h4>
<p>The budgets config file belongs to the Emma Visualiser. For a description, please see: <strong><code>doc/readme-vis.md</code></strong>.</p>
<h4 id="categoriesobjectsjson-and-categoriessectionsjson"><code>categoriesObjects.json</code> and <code>categoriesSections.json</code><a class="headerlink" href="#categoriesobjectsjson-and-categoriessectionsjson" title="Permanent link">&para;</a></h4>
<p>The categories config files are used to categorize objects and sections to user defined categories by using their full names.
These files are optional, if no categorization needed, these config files do not need to be created.
This function can be used for example to group the software components of one company together which will make the results easier to understand.</p>
<p>The <code>categoriesObjects.json</code> is used for the objects and the <code>categoriesSections.json</code> is  used for the section categorization.
The objects and sections will be first tried to be categorized by these files. If they could not be categorized, then the software will try
to categorize them based on the <code>categoriesObjectsKeywords.json</code> and <code>categoriesSectionsKeywords.json</code> files.</p>
<p>These config files have to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;&lt;CATEGORY&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;NAME&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;NAME&gt;&quot;</span>
    <span class="p">],</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="nt">&quot;&lt;CATEGORY&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;NAME&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;NAME&gt;&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;CATEGORY&gt;</code> is a string containing a unique category name</li>
<li><code>&lt;NAME&gt;</code> is a string</li>
</ul>
</li>
<li>The categorisation can be done either by hand or with the <strong>--create_categories</strong> command line argument (for usage see there)</li>
<li>The <code>&lt;NAME&gt;</code> has to contain full names of the sections or objects</li>
</ul>
<h4 id="categoriesobjectskeywordsjson-and-categoriessectionskeywordsjson"><code>categoriesObjectsKeywords.json</code> and <code>categoriesSectionsKeywords.json</code><a class="headerlink" href="#categoriesobjectskeywordsjson-and-categoriessectionskeywordsjson" title="Permanent link">&para;</a></h4>
<p>The categories keywords config files are used to categorize objects and sections to user defined categories by using only substrings of their names.
These files are optional, if no categorization needed, these config files do not need to be created.
This function can be used for example to group the software components of one company together which will make the results easier to understand.</p>
<p>The <code>categoriesObjectsKeywords.json</code> is used for the objects and the <code>categoriesSectionsKeywords.json</code> is  used for the section categorization.
The objects and sections will only tried to be categorized by these files if the categorization by the <code>categoriesObjects.json</code> and <code>categoriesSections.json</code> files failed.
If they could not be categorized, then the software will assign them to a category called <code>&lt;Emma_UnknownCategory&gt;</code> so they will be more visible in the results.</p>
<p>These config files have to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;&lt;CATEGORY&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;KEYWORD&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;KEYWORD&gt;&quot;</span>
    <span class="p">],</span>
    <span class="nt">&quot;&lt;CATEGORY&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;KEYWORD&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;KEYWORD&gt;&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;CATEGORY&gt;</code> is a string containing a unique category name</li>
<li><code>&lt;KEYWORD&gt;</code> is a string</li>
</ul>
</li>
<li>The categorisation has to be done by hand</li>
<li>The <code>&lt;KEYWORD&gt;</code> contains a regex pattern for the names of the sections or objects</li>
</ul>
<h3 id="formal-definition-of-the-ghs-compiler-specific-configuration">Formal Definition of the GHS compiler specific configuration<a class="headerlink" href="#formal-definition-of-the-ghs-compiler-specific-configuration" title="Permanent link">&para;</a></h3>
<p>The GHS compiler specific part of the configuration contains the following files:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="o">+</span><span class="c1">-- [&lt;PROJECT&gt;]</span>
<span class="o">|</span>   <span class="o">+</span><span class="c1">-- &lt;GENERIC_CONFIGURATION_FILES&gt;</span>
<span class="o">|</span>   <span class="o">+</span><span class="c1">-- patterns*.json</span>
<span class="o">|</span>   <span class="o">+</span><span class="c1">-- virtualSections*.json</span>
</pre></div>
</td></tr></table>

<p>The following dependencies exist within this type of a configuration:</p>
<div align="center"> <img src="./images/configDependencies.png" width="100%"> </div>

<p>In <code>globalConfig.json</code>, you need to reference (ref relations on the picture):</p>
<ol>
<li><code>addressSpaces*.json</code></li>
<li><code>patterns*.json</code></li>
<li><code>sections*.json</code></li>
</ol>
<p><code>memRegionExcludes</code>: You can exclude certain memory regions with this keyword in <code>patterns*.json</code>. In order to do this the memory regions/tags must match with those defined in <code>addressSpaces*.json</code>.</p>
<p>If you have virtual address spaces (VASes) defined. You need a <code>"monolith file"</code> pattern defined in <code>patterns*.json</code> in order to be able to translate virtual addresses back to physical addresses. In the same file you give each VAS a name. This name is later used to identify which section belongs to which VAS (defined in <code>virtualSections*.json</code>). The VAS names must match between those two files. This is needed in order to avoid name clashes of sections names between different VASes.</p>
<h4 id="extensions-to-the-globalconfigjson">Extensions to the <code>globalConfig.json</code><a class="headerlink" href="#extensions-to-the-globalconfigjson" title="Permanent link">&para;</a></h4>
<p>The globalConfig.json has to have the following format <strong>for configId-s that have selected "GHS" as compiler</strong>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;&lt;CONFIG_ID&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="err">&lt;GENERIC_KEY_VALUE_PAIRS&gt;,</span>
        <span class="nt">&quot;patternsPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;virtualSectionsPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span>
    <span class="p">},</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="err">.</span>
    <span class="nt">&quot;&lt;CONFIG_ID&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="err">&lt;GENERIC_KEY_VALUE_PAIRS&gt;,</span>
        <span class="nt">&quot;patternsPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span><span class="p">,</span>
        <span class="nt">&quot;virtualSectionsPath&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;CONFIG_FILE&gt;&quot;</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The types used in the description:<ul>
<li><code>&lt;GENERIC_KEY_VALUE_PAIRS&gt;</code> are the key-value pairs discussed in the <a href="#formal-definition-of-the-generic-configuration">Formal definition of the generic configuration</a> chapter</li>
<li><code>&lt;CONFIG_FILE&gt;</code> is a string</li>
</ul>
</li>
<li>You must assign a patterns config file for each configID by defining the <strong>patternsPath</strong> key</li>
<li>If the configId contains virtual address spaces, you must assign a config file describing them by defining <strong>virtualSectionsPath</strong> key</li>
<li>The assigned config files have to be in the same folder as the globalConfig.json</li>
<li>The config files don't need to be different for each configID (for example you can use the same virtual sections config file for all the configIDs)</li>
</ul>
<h4 id="patternsjson"><code>patterns*.json</code><a class="headerlink" href="#patternsjson" title="Permanent link">&para;</a></h4>
<p>The patterns config files define regex patterns for finding the mapfiles, monolith files and processing their content.
They belong to the <code>configID</code> they were assigned to in the <code>globalConfigs.json</code>.</p>
<p>These config files have to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;mapfiles&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;&lt;SW_NAME&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;regex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">],</span>
            <span class="nt">&quot;VAS&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;VAS_NAME&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UniquePatternSections&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UniquePatternObjects&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;memRegionExcludes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">]</span>
        <span class="p">},</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="nt">&quot;&lt;SW_NAME&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;regex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">],</span>
            <span class="nt">&quot;VAS&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;VAS_NAME&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UniquePatternSections&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;UniquePatternObjects&quot;</span><span class="p">:</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span>
            <span class="nt">&quot;memRegionExcludes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;MEMORY_AREA&gt;&quot;</span><span class="p">]</span>
        <span class="p">},</span>
    <span class="p">},</span>
    <span class="nt">&quot;monoliths&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&quot;&lt;MONILITH_NAME&gt;&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&quot;regex&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">,</span> <span class="err">...</span> <span class="s2">&quot;&lt;REGEX_PATTERN&gt;&quot;</span><span class="p">]</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;SW_NAME&gt;</code> is a string containing a unique name</li>
<li><code>&lt;REGEX_PATTERN&gt;</code> is a string containing a regex pattern following the format used by the "re" Python library</li>
<li><code>&lt;VAS_NAME&gt;</code> is a string</li>
<li><code>&lt;MONOLITH_NAME&gt;</code> is a string containing a unique name</li>
</ul>
</li>
<li>The <strong>mapfiles</strong> object must be present in the file with at least one entry:<ul>
<li>Each entry describes a SW unit of the configId (eg. a bootloader or application if an MCU is used or a process if an OS, like Linux is used):<ul>
<li>The <strong>regex</strong> defines one ore more regex pattern to find the mapfile that contains the data for this SW unit:<ul>
<li>It is possible to give more than one regex patterns in case of non-uniform mapfile names</li>
<li>If more than one map file will be found for the SW unit, a warning will be thrown</li>
<li>The search will be done in the mapfile folder defined by the command line arguments</li>
</ul>
</li>
<li>The <strong>VAS</strong> is optional element, defining the name of the virtual address space of this SW unit<ul>
<li>It is only required if the SW unit has entries that belong to virtual address spaces</li>
<li>More than one mapfiles can contain data belonging to one virtual address space, so the VAS name does not need to be unique</li>
</ul>
</li>
<li>The <strong>UniquePatternSections</strong> is an optional element defining a regex pattern for collecting the sections from the mapfile<ul>
<li>It only needs to be defined if the default regex pattern has to be overridden</li>
<li>This can be necessary if the toolchain where the mapfile coming from, produces another format</li>
</ul>
</li>
<li>The <strong>UniquePatternObjects</strong> is an optional element defining a regex pattern for collecting the objects from the mapfile<ul>
<li>It only needs to be defined if the default regex pattern has to be overridden</li>
<li>This can be necessary if the toolchain where the mapfile coming from, produces another format</li>
</ul>
</li>
<li>The <strong>memRegionExcludes</strong> lists the memory areas that needs to be ignored during the analysis of the mapfile<ul>
<li>The sections and objects of the mapfile that belong to the memory areas listed here will be ignored</li>
<li>The memory areas can be selected from the <MEMORY_AREA> elements defined in the "memory" object of address spaces config file</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li>The <strong>monoliths</strong> object is optional, it is only needed if the configId has virtual address spaces<ul>
<li>If one the of the mapfiles object has a VAS key, then a monolith is needed</li>
<li>It is possible to give more than one regex patterns in case of non-uniform monolith file names</li>
<li>If more than one monolith file will be found for the SW unit, a warning will be thrown</li>
<li>The search will be done in the mapfile folder defined by the command line arguments</li>
</ul>
</li>
</ul>
<h4 id="virtualsectionsjson"><code>virtualSections*.json</code><a class="headerlink" href="#virtualsectionsjson" title="Permanent link">&para;</a></h4>
<p>The virtual sections config files are used to assign the sections of the virtual address spaces to
a virtual address spaces defined in the <code>patterns*.json</code>file. This is needed because the mapfiles can contain physical
and virtual sections as well and Emma needs to identify the virtual ones and assign them to a specific virtual address space.
If your configuration does not use virtual address spaces, the <code>virtualSections*.json</code> file is not needed.</p>
<p>This config file have to have the following format:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">{</span>
    <span class="nt">&quot;&lt;VAS_NAME&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;SECTION_NAME&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;SECTION_NAME&gt;&quot;</span>
    <span class="p">],</span>
    <span class="err">...</span>
    <span class="nt">&quot;&lt;VAS_NAME&gt;&quot;</span><span class="p">:</span> <span class="p">[</span>
        <span class="s2">&quot;&lt;SECTION_NAME&gt;&quot;</span><span class="p">,</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="err">.</span>
        <span class="s2">&quot;&lt;SECTION_NAME&gt;&quot;</span>
    <span class="p">]</span>
<span class="p">}</span>
</pre></div>
</td></tr></table>

<p>The following rules apply:</p>
<ul>
<li>The file contains a single unnamed JSON object</li>
<li>The types used in the description:<ul>
<li><code>&lt;VAS_NAME&gt;</code> is a string</li>
<li><code>&lt;SECTION_NAME&gt;</code> is a string</li>
</ul>
</li>
<li>The <code>&lt;VAS_NAME&gt;</code> keys are the ones that were defined in the <code>patterns*.json</code></li>
<li>Every <code>&lt;VAS_NAME&gt;</code> key has an array as value that lists the sections that belong to the virtual address space </li>
<li>There are no rules for the assignment, this needs to be done intuitively based on the project being analyzed</li>
</ul>
<h2 id="output-files">Output Files<a class="headerlink" href="#output-files" title="Permanent link">&para;</a></h2>
<p>The output Files will be saved to the memStats folder of the respective project. The filename will have this form: </p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>&lt;PROJECT_NAME&gt;_Section_Summary_TIMESTAMP.csv
&lt;PROJECT_NAME&gt;_Object_Summary_TIMESTAMP.csv
&lt;PROJECT_NAME&gt;_Objects_in_Sections_TIMESTAMP.csv
</pre></div>
</td></tr></table>

<h3 id="section-summary">Section Summary<a class="headerlink" href="#section-summary" title="Permanent link">&para;</a></h3>
<p>The file <code>&lt;PROJECT_NAME&gt;_Section_Summary_&lt;TIMESTAMP&gt;.csv</code> contains the sections from the mapfiles.</p>
<h3 id="object-summary">Object Summary<a class="headerlink" href="#object-summary" title="Permanent link">&para;</a></h3>
<p>The file <code>&lt;PROJECT_NAME&gt;_Object_Summary_&lt;TIMESTAMP&gt;.csv</code> contains the objects from the mapfiles.</p>
<h3 id="objects-in-sections">Objects in Sections<a class="headerlink" href="#objects-in-sections" title="Permanent link">&para;</a></h3>
<p>"Objects in sections" provides ways to obtain a finer granularity of the categorisation result. Therefore categorised sections containing (smaller) objects of a different category got split up and result into a more accurate categorisation. As a result you will get output files in form of a <code>.csv</code> file which sets you up to do later processing on this data easily. In this file additional information is added like:</p>
<ul>
<li>Overlaps (of sections/objects)</li>
<li>Containments (e.g. sections containing objects)</li>
<li>Duplicates</li>
<li>All meta data about the origin of each section/object (mapfile, addess space, ...)</li>
<li>...</li>
</ul>
<div align="center"> <img src="./images/objectsInSections.png" width="90%"> </div>

<p>The file <code>&lt;PROJECT_NAME&gt;_Objects_in_Sections_&lt;TIMESTAMP&gt;.csv</code> is the result of the "merge" of the objects and the sections file.</p>
<p>Objects/sections that are "touching" or overlapping each other in some way (see the above figure) are resolved in this step. Therefore the "weaker" section/object is split (and has therefore a reduced by size after each step).</p>
<p>This is done so that the file represents a continuous and refined memory mapping. Furthermore it is checked whether sections/objects overlap, contain or duplicate each other.</p>
<p>The information on such occurrences can be observed in the rightmost columns:</p>
<ul>
<li><code>overlapFlag</code>: Overlaps with the stated section ("overlapped by X" means X is an object/section which has a lower start address and therefore overlaps the current element)</li>
<li><code>containmentFlag</code>: Is contained by the stated section</li>
<li><code>duplicateFlag</code>: Duplicate entry</li>
<li><code>containgOthers</code>: Contains stated sections/objects</li>
<li><code>addrStartHexOriginal</code>: Address before correction (in contrast to the "new" addresses due to the above actions)</li>
<li><code>addrEndHexOriginal</code>: Address before correction (in contrast to the "new" addresses due to the above actions)</li>
</ul>
<p>The above figure also shows how sizes of objects/sections are calculated correctly (-&gt; namely: <code>start - end + 1</code>). Besides this a specific case of an overlap is shown above. A section/object having the same end address like the start address of another section/object. This happens to be already an overlap of one byte.</p>
<p>As a result you see the <code>+ 1</code> addition for the size calculation.
This might sound counter-intuitive at the first spot. However we can see memory addresses as memory blocks itself rather than infinitesimal barriers (what the term start and end address would intuitively suggest by its name).</p>
<p>At the end you will find three remaining "types":</p>
<ol>
<li><strong>Real objects:</strong> (Un)modified objects due to the above actions</li>
<li><strong>Section reserves:</strong> Resolved sections minus resolved objects; this is what remains when you resolve all "touching" occurrences and subtract objects from sections that we obtain (multiple) smaller sections</li>
<li><strong>Section entry:</strong> The original section size (without any modification); this is a pure virtual entry and has a size of <code>0</code> bytes; these are the only <code>0</code> byte sections which are a result of the Emma processing</li>
</ol>
<p>Section names for section reserves and entries are <code>&lt;Emma_SectionReserve&gt;</code> and <code>&lt;Emma_SectionEntry&gt;</code> respectively. The <code>&lt;Emma_xxxx&gt;</code> pattern shows you names introduced by Emma.</p>
<h3 id="csv-header">CSV header<a class="headerlink" href="#csv-header" title="Permanent link">&para;</a></h3>
<p>The CSV file has the following columns:</p>
<ul>
<li>The address start, end and sizes: <code>addrStartHex; addrEndHex; sizeHex; addrStartDec; addrEndDec; sizeDec; sizeHumanReadable</code></li>
<li>The section and object name: <code>sectionName; moduleName</code> Note: If the image summary contains only sections, the column moduleName will be left empty.</li>
<li><code>configID</code>, <code>memType</code> and <code>tag</code> are from the config files.</li>
<li><code>vasName</code> is the virtual address space name defined in sections.json. The <code>DMA</code> field indicates whether a section/object is in a VAS. </li>
<li><code>category</code>: The category evaluated from categories*.json</li>
<li><code>mapfile</code>: The mapfile, the entry originates from.</li>
<li><code>overlapFlag</code>: Indicates whether one section overlaps with another.</li>
<li><code>containmentFlag</code>: Indicates whether a section is contained in another.</li>
<li><code>duplicateFlag</code>: Indicates whether a section has duplicates.</li>
</ul>
<h2 id="terminology">Terminology<a class="headerlink" href="#terminology" title="Permanent link">&para;</a></h2>
<p>In places there is some specific terminology used which is explained in the following chapter:</p>
<ul>
<li>DMA: Direct Memory Addressing; addresses which do not have to be translated (from virtual to physical); this has nothing to do with direct access to memory on the target (by bypassing the CPU core(s))</li>
<li>Emma was formerly known as MAdZ</li>
</ul>
<h2 id="examples">Examples<a class="headerlink" href="#examples" title="Permanent link">&para;</a></h2>
<p>Create a Mapfile Summary for <PROJECT>:</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>Emma.py a --project ..<span class="se">\&lt;</span>PROJECT&gt; <span class="se">\</span>
--mapfiles ..<span class="se">\M</span>yMapfiles <span class="se">\</span>
--dir ..<span class="se">\M</span>yMapfiles<span class="se">\r</span>esults
</pre></div>
</td></tr></table>

<h3 id="matching-object-name-and-category-using-categorieskeywordsjson">Matching object name and category using <code>categoriesKeywords.json</code><a class="headerlink" href="#matching-object-name-and-category-using-categorieskeywordsjson" title="Permanent link">&para;</a></h3>
<p><code>categoriesObjectsKeywords.json</code> can be used to match object names with catgories by user defined keywords.</p>
<ul>
<li>Arguments required:  <code>--create_categories</code></li>
<li>This step will append the newly categorised modules to <code>categories.json</code>. The program will ask you to confirm to overwrite the file.</li>
</ul>
<h3 id="removing-not-needed-object-names-from-categoriesobjectsjson">Removing not needed object names from <code>categoriesObjects.json</code><a class="headerlink" href="#removing-not-needed-object-names-from-categoriesobjectsjson" title="Permanent link">&para;</a></h3>
<p>Not needed object names can be removed from <code>categoriesObjects.json</code>, for example when <code>categoriesObjects.json</code> from another project is used.</p>
<ul>
<li>Arguments required:  <code>--remove_unmatched</code></li>
<li>This step will remove never matching object names from <code>categoriesObjects.json</code>. Some modules never match because e.g. the object got removed or is not present in the current release. The program will ask you to confirm to overwrite the file.</li>
</ul>
<h2 id="general-information-about-map-files-and-build-chains">General Information About Map Files and Build Chains<a class="headerlink" href="#general-information-about-map-files-and-build-chains" title="Permanent link">&para;</a></h2>
<ul>
<li><a href="http://www.tenouk.com/ModuleW.html">COMPILER, ASSEMBLER, LINKER AND LOADER: A BRIEF STORY</a></li>
<li><a href="http://resources.infosecinstitute.com/hello-world-c-assembly-object-file-and-executable">Hello World: C, Assembly, Object File and Executable</a></li>
<li><a href="https://www.embeddedrelated.com/showarticle/900.php">Analyzing the Linker Map file with a little help from the ELF and the DWARF</a></li>
<li><a href="http://duartes.org/gustavo/blog/post/anatomy-of-a-program-in-memory">Anatomy of a Program in Memory</a></li>
<li><a href="https://www.cs.rutgers.edu/~pxk/416/notes/10-paging.html">Memory Management: Paging</a></li>
<li><a href="http://www.lurklurk.org/linkers/linkers.html">Beginner's Guide to Linkers</a></li>
<li><a href="http://www.scoberlin.de/content/media/http/informatik/gcc_docs/ld_3.html">Linker Scripts</a></li>
</ul>
<h2 id="technical-details">Technical Details<a class="headerlink" href="#technical-details" title="Permanent link">&para;</a></h2>
<h3 id="ghs-monolith-file-generation">GHS Monolith file generation<a class="headerlink" href="#ghs-monolith-file-generation" title="Permanent link">&para;</a></h3>
<p>Execute this to generate the monolith files (you need to have the ELF file for this step).</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>gdump.exe -virtual_mapping -no_trunc_sec_names Application.elf &gt;&gt; monolith.map
gdump.exe -map             -no_trunc_sec_names Application.elf &gt;&gt; monolith.map
</pre></div>
</td></tr></table>

<p>By default long names will be truncated. This can lead to inaccurate results. In order to prevent this use <code>-no_trunc_sec_names</code>.</p>
<h3 id="class-diagram-emma">Class diagram Emma<a class="headerlink" href="#class-diagram-emma" title="Permanent link">&para;</a></h3>
<p><div align="center"> <img src="images/emmaClassDiagram.png" width="1000"> </div></p>
<h3 id="calling-graph-emma">Calling Graph Emma<a class="headerlink" href="#calling-graph-emma" title="Permanent link">&para;</a></h3>
<p><div align="center"> <img src="../genDoc/call_graph_uml/emma_filtered.profile.png" onerror="this.onerror=null;this.src='https%3A%2F%2Fgithub.com%2Fbmwcarit%2FEmma%2Fblob%2Fmaster%2FgenDoc%2Fcall_graph_uml%2Femma_filtered.profile.png';" width="1000"> </div></p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="index.html" title="Home" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Home
              </span>
            </div>
          </a>
        
        
          <a href="readme-vis.html" title="Emma Visualiser" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                Emma Visualiser
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            The Emma Authors
          </div>
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
  <div class="md-footer-social">
    <link rel="stylesheet" href="assets/fonts/font-awesome.css">
    
      <a href="https://github.com/bmwcarit/Emma" class="md-footer-social__link fa fa-github"></a>
    
  </div>

    </div>
  </div>
</footer>
      
    </div>
    
      <script src="assets/javascripts/application.c648116f.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:"."}})</script>
      
    
  </body>
</html>